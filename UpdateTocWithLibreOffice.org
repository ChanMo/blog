#+TITLE: Update Toc with LibreOffice Command
#+DESCRIPTION: update 'table of contents' by libreoffice from command line
#+KEYWORDS: libreoffice, soffice, basic, macro, toc
#+HTML_LINK_HOME: /blog

TOC is Table of Contents

** Create Macro Module

#+BEGIN_SRC basic
REM  *****  BASIC  *****

 Option Explicit
 
 Sub UpdateIndexes(path As String)
     '''Update indexes, such as for the table of contents''' 
     Dim doc As Object
     Dim args()
 
     doc = StarDesktop.loadComponentFromUrl(convertToUrl(path), "_default", 0, args())
 
     Dim i As Integer
 
     With doc ' Only process Writer documents
         If .supportsService("com.sun.star.text.GenericTextDocument") Then
             For i = 0 To .getDocumentIndexes().count - 1
                 .getDocumentIndexes().getByIndex(i).update()
             Next i
         End If
     End With ' ThisComponent
 
     doc.store()
     doc.close(True)
 
 End Sub ' UpdateIndexes  
#+END_SRC


** Run Command

#+BNGIN_SRC bash
$ soffice --headless "macro:///Standard.YourModuleName.UpdateIndex(/path/to/file.odt)"
#+END_SRC
